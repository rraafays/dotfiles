#!/bin/bash

echo "REPLICATE: grabbing portage tree based on machine name"
rm -rf /etc/portage
git clone https://github.com/rraafays/$HOSTNAME /etc/portage

echo "REPLICATE: synchronising packages with database"
emerge --sync

echo "REPLICATE: synchronising world file"
cp .packages/emerge /var/lib/portage/world
emerge --quiet --update --deep --newuse @world

echo "REPLICATE: enabling services for hyprland"
rc-update add elogind default
rc-update add dbus default
rc-service elogind start
rc-service dbus start

echo "REPLICATE: checking for package news"
eselect news read

echo "REPLICATE: applying sudo => doas symlink"
doas ln -s (which doas) sudo

echo "REPLICATE: applying userchrome"
for dir in $HOME/.librewolf/*; do mkdir -- "$dir/chrome"; done
cp $HOME/.config/etc/modifications/librewolf/userChrome.css $HOME/.librewolf/*/chrome/
