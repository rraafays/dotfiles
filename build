#!/bin/bash

if [ "$1" == "clean" ]; then
  cd .base && stow --delete . && cd ..
  cd .linux && stow --delete . && cd ..
  cd .macos && stow --delete . && cd ..
else
  OS=$(uname -s | tr A-Z a-z)
  HOSTNAME=$(hostname -s | tr A-Z a-z)

  if [ "$OS" == "darwin" ]; then
    bash .scripts/brew_replicate
    cd .macos && stow . && cd ..
  fi
  if [ "$OS" == "linux" ]; then
    doas bash .scripts/emerge_replicate
    cd .linux && stow . && cd ..
  fi
  cargo install $(cat .packages/cargo)

  rm -rf fish kitty
  cd .base && stow . && cd ..
fi
